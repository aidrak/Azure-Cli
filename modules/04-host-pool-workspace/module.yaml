# ==============================================================================
# Module: Host Pool & Workspace for Azure Virtual Desktop
# ==============================================================================
module:
  id: "04-host-pool-workspace"
  name: "Host Pool & Workspace"
  description: "Create and configure AVD Host Pool, Workspace, and Application Group."

  # Module-level configuration
  config:
    resource_group: "{{AZURE_RESOURCE_GROUP}}"
    location: "{{AZURE_LOCATION}}"
    host_pool_name: "{{HOST_POOL_NAME}}"
    workspace_name: "{{WORKSPACE_NAME}}"

  # Operations in this module (executed in order)
  operations:
    - id: "hostpool-create-pool"
      name: "Create AVD Host Pool"
      description: "Create the AVD host pool with type, load balancer, and session limit from config."
      script: "create-host-pool.sh"
      duration: 120

    - id: "hostpool-configure-rdp"
      name: "Configure Host Pool RDP Properties"
      description: "Set custom RDP properties on the host pool for SSO and device redirection."
      script: "configure-rdp.sh"
      duration: 60

    - id: "hostpool-create-app-group"
      name: "Create Desktop Application Group"
      description: "Create a desktop application group and associate it with the host pool."
      script: "create-app-group.sh"
      duration: 90

    - id: "hostpool-create-workspace"
      name: "Create AVD Workspace"
      description: "Create the AVD workspace and register the application group to it."
      script: "create-workspace.sh"
      duration: 90

    - id: "hostpool-validate-all"
      name: "Validate Host Pool and Workspace"
      description: "Validate the successful creation and configuration of all resources."
      script: "validate-all.sh"
      duration: 60

  # Expected total duration
  total_duration:
    expected: 420      # 7 minutes
    timeout: 840       # 14 minutes

  # Module state file
  state_file: "modules/04-host-pool-workspace/state.json"

  # Artifacts
  artifacts:
    logs: "artifacts/logs/"
    outputs: "artifacts/outputs/"
    scripts: "artifacts/scripts/"
