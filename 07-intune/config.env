#!/bin/bash

################################################################################
# Configuration for 07-intune
################################################################################

# Load centralized configuration
CENTRALIZED_CONFIG="${CENTRALIZED_CONFIG:-../config/avd-config.sh}"
[[ -f "$CENTRALIZED_CONFIG" ]] && source "$CENTRALIZED_CONFIG"

# ============================================================================
# AZURE ENVIRONMENT
# ============================================================================

export SUBSCRIPTION_ID="${SUBSCRIPTION_ID:-}"
export TENANT_ID="${TENANT_ID:-}"
export RESOURCE_GROUP_NAME="${RESOURCE_GROUP_NAME:-RG-Azure-VDI-01}"
export LOCATION="${LOCATION:-centralus}"

# ============================================================================
# DEVICE COMPLIANCE POLICIES
# ============================================================================

export COMPLIANCE_POLICY_NAME="${COMPLIANCE_POLICY_NAME:-AVD-Compliance-Policy}"
export REQUIRE_ENCRYPTION="${REQUIRE_ENCRYPTION:-true}"
export REQUIRE_ANTIVIRUS="${REQUIRE_ANTIVIRUS:-true}"
export REQUIRE_FIREWALL="${REQUIRE_FIREWALL:-true}"

# ============================================================================
# CONFIGURATION PROFILES
# ============================================================================

# Windows Defender settings
export ENABLE_WINDOWS_DEFENDER="${ENABLE_WINDOWS_DEFENDER:-true}"
export ENABLE_REAL_TIME_MONITORING="${ENABLE_REAL_TIME_MONITORING:-true}"

# BitLocker encryption
export ENABLE_BITLOCKER="${ENABLE_BITLOCKER:-false}"

# Windows Update settings
export ENABLE_AUTO_UPDATE="${ENABLE_AUTO_UPDATE:-true}"
export UPDATE_RING="${UPDATE_RING:-Semi-Annual}"

# ============================================================================
# AVD-SPECIFIC POLICIES (Parts 5 & 6)
# ============================================================================

# Part 5: Hide Shutdown Button Policy
export HIDE_SHUTDOWN_BUTTON="${HIDE_SHUTDOWN_BUTTON:-true}"
export SHUTDOWN_POLICY_NAME="${SHUTDOWN_POLICY_NAME:-AVD - Hide Shutdown Button}"
export SHUTDOWN_POLICY_DEVICE_GROUP="${SHUTDOWN_POLICY_DEVICE_GROUP:-AVD-Devices-Pooled-Network}"

# Part 6: AutoEndTasks (Auto-Close Applications on Logoff)
export ENABLE_AUTO_END_TASKS="${ENABLE_AUTO_END_TASKS:-true}"
export AUTO_END_TASKS_POLICY_NAME="${AUTO_END_TASKS_POLICY_NAME:-AVD - Auto End Tasks on Logoff}"
export AUTO_END_TASKS_USER_GROUP="${AUTO_END_TASKS_USER_GROUP:-AVD-Users-Pooled}"
export WAIT_TO_KILL_APP_TIMEOUT="${WAIT_TO_KILL_APP_TIMEOUT:-5000}"

# ============================================================================
# APPLICATION DEPLOYMENT
# ============================================================================

# Microsoft 365 Apps
export DEPLOY_MICROSOFT_365="${DEPLOY_MICROSOFT_365:-true}"

# Teams
export DEPLOY_TEAMS="${DEPLOY_TEAMS:-true}"
export TEAMS_VERSION="${TEAMS_VERSION:-latest}"

# ============================================================================
# LOGGING & ARTIFACTS
# ============================================================================

export LOG_LEVEL="${LOG_LEVEL:-INFO}"
export ENABLE_LOGGING="${ENABLE_LOGGING:-1}"
export ARTIFACTS_DIR="${ARTIFACTS_DIR:-artifacts}"

# ============================================================================
# TIMEOUTS
# ============================================================================

export OPERATION_TIMEOUT="${OPERATION_TIMEOUT:-600}"
export POLLING_INTERVAL="${POLLING_INTERVAL:-10}"

