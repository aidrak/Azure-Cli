# Catalog of all available applications for the golden image.
# The installation engine will select from this list based on config.yaml.
chrome:
  name: "Google Chrome"
  source_type: "Url"
  url_type: "permalink" # The standalone enterprise installer is regularly updated at this link.
  url: "https://dl.google.com/dl/chrome/install/googlechromestandaloneenterprise64.msi"
  outfile: "C:\\Temp\\Chrome.msi"
  install_command: "msiexec.exe"
  install_args: '/i "{outfile}" /quiet /norestart'
  success_codes: [0, 3010]

adobereader:
  name: "Adobe Acrobat DC"
  source_type: "Url"
  url_type: "static" # This URL is version-specific and will need to be updated.
  url: "https://trials.adobe.com/AdobeProducts/APRO/Acrobat_HelpX/win32/Acrobat_DC_Web_x64_WWMUI.zip"
  outfile: "C:\\Temp\\Acrobat_DC_Web.zip"
  source_format: "zip" # Indicates the outfile needs to be extracted
  unzip_dir: "C:\\Temp\\Acrobat_DC"
  install_command: '"{unzip_dir}\\Adobe Acrobat\\Setup.exe"' # Path to installer inside the zip
  install_args: "/sAll" # Standard silent switch for Adobe Setup.exe
  success_codes: [0]

vscode:
  name: "Visual Studio Code"
  source_type: "Url"
  url_type: "permalink" # Official permalink for the latest stable system installer.
  url: "https://code.visualstudio.com/sha/download?build=stable&os=win32-x64-system"
  outfile: "C:\\Temp\\VSCodeSetup.exe"
  install_command: '"{outfile}"'
  install_args: "/verysilent /mergetasks=!runcode"
  success_codes: [0]

teams:
  name: "Microsoft Teams for VDI"
  source_type: "Url"
  url_type: "permalink" # Official FWLink for the latest VDI machine-wide installer.
  url: "https://go.microsoft.com/fwlink/?linkid=2196106"
  outfile: "C:\\Temp\\Teams_windows_x64.msi"
  install_command: "msiexec.exe"
  install_args: '/i "{outfile}" /quiet /norestart ALLUSERS=1'
  success_codes: [0, 3010]

office365:
  name: "Microsoft 365 Apps (includes Access)"
  source_type: "Script"
  install_command: "powershell.exe"
  install_args: '-ExecutionPolicy Bypass -Command "& { $tempDir = \"C:\\Temp\"; $configXml = \"$tempDir\\office365-config.xml\"; $xmlContent = @\"\n<Configuration>\n  <Add OfficeClientEdition=\"64\" Channel=\"Current\">\n    <Product ID=\"O365ProPlusRetail\">\n      <Language ID=\"en-us\" />\n    </Product>\n  </Add>\n  <Display Level=\"None\" AcceptEULA=\"TRUE\" />\n  <Property Name=\"AUTOACTIVATE\" Value=\"1\" />\n</Configuration>\n\"@; New-Item -ItemType Directory -Path $tempDir -Force | Out-Null; $xmlContent | Out-File -FilePath $configXml -Encoding UTF8; $odtPath = \"$tempDir\\setup.exe\"; Invoke-WebRequest -Uri \"https://download.microsoft.com/download/2/7/A/27AF1BE6-DD20-4CB4-B154-EBAB8A7D4A7E/officedeploymenttool_17830-20162.exe\" -OutFile \"$tempDir\\ODT.exe\" -UseBasicParsing; Start-Process -FilePath \"$tempDir\\ODT.exe\" -ArgumentList \"/quiet\",\"/extract:$tempDir\" -Wait; Start-Process -FilePath $odtPath -ArgumentList \"/configure\",$configXml -Wait -NoNewWindow; Remove-Item \"$tempDir\\ODT.exe\",\"$tempDir\\setup.exe\",$configXml -Force -ErrorAction SilentlyContinue }"'
  success_codes: [0]